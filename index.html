<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
    <title>THE JOURNEY</title>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/ScrollTrigger.min.js"></script>

    <style>
        :root { --bg-color: #000000; }
        * { box-sizing: border-box; margin: 0; padding: 0; }
        
        body {
            background-color: var(--bg-color);
            height: 100vh;
            overflow: hidden;
            margin: 0;
            -webkit-font-smoothing: antialiased;
        }

        /* --- LIQUID LOADER --- */
        #loader {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: #000;
            z-index: 10000;
            display: flex; justify-content: center; align-items: center;
        }

        .liquid-shape {
            width: 80px; height: 80px;
            background: #fff;
            border-radius: 40% 60% 70% 30% / 40% 50% 60% 50%;
            filter: blur(2px);
            box-shadow: 0 0 40px rgba(255,255,255,0.4);
            will-change: transform, border-radius;
        }

        /* --- VIDEO STAGE --- */
        .stage { position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: 0; }
        video { width: 100%; height: 100%; object-fit: cover; opacity: 0; display: block; will-change: transform; }

        .flash {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: white; z-index: 10001; opacity: 0; pointer-events: none;
        }
    </style>
</head>
<body>

    <div id="loader">
        <div class="liquid-shape" id="shape"></div>
    </div>

    <div class="flash" id="flash"></div>

    <div class="stage">
        <video id="video" muted playsinline preload="auto">
            <source src="journey.mp4" type="video/mp4">
        </video>
    </div>

    <script>
        gsap.registerPlugin(ScrollTrigger);
        const shape = document.getElementById('shape');
        const video = document.getElementById('video');

        // Smooth Organic Animation
        gsap.to(shape, {
            borderRadius: "60% 40% 30% 70% / 60% 30% 70% 40%",
            duration: 2.5,
            repeat: -1,
            yoyo: true,
            ease: "sine.inOut"
        });

        gsap.to(shape, {
            scale: 1.1,
            duration: 1.8,
            repeat: -1,
            yoyo: true,
            ease: "sine.inOut"
        });

        // Fast Load & Transition
        const handleLoad = () => {
            const tl = gsap.timeline({
                delay: 0.5, // Kleiner Moment für die Ästhetik
                onComplete: () => {
                    document.getElementById('loader').style.display = "none";
                    document.body.style.overflow = "auto";
                    document.body.style.height = "500vh"; // Länge für flüssiges Scrollen
                    initScroll();
                }
            });

            tl.to(shape, { scale: 30, duration: 0.8, ease: "expo.in" });
            tl.to("#flash", { opacity: 1, duration: 0.2 }, "-=0.2");
            tl.set(video, { opacity: 1 });
            tl.to("#flash", { opacity: 0, duration: 0.8 });
        };

        // Prüfen ob Video geladen ist
        if (video.readyState >= 3) {
            handleLoad();
        } else {
            video.addEventListener('canplaythrough', handleLoad, { once: true });
        }

        function initScroll() {
            // Video-Interaktion vorbereiten
            video.play().then(() => video.pause());
            
            // Hochperformantes Scroll-Mapping
            ScrollTrigger.create({
                trigger: "body",
                start: "top top",
                end: "bottom bottom",
                scrub: 0.1, // Minimale Verzögerung für extreme Smoothie-Haptik
                onUpdate: (self) => {
                    if (video.duration) {
                        // Präzise Berechnung ohne Ruckler
                        video.currentTime = self.progress * (video.duration - 0.05);
                    }
                }
            });
        }
    </script>
</body>
</html>
